<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>From R to Julia | My Site</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About Me</a></li>
      
      <li><a href="/topic/">Posts</a></li>
      
      <li><a href="/cv/">CV</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">From R to Julia</span></h1>

<p class="terms">
    
    
    Categories: <a href="/categories/tutorials">Tutorials</a> 
    
    
    
    Tags: <a href="/tags/julia">Julia</a> <a href="/tags/r">R</a> <a href="/tags/programming">Programming</a> <a href="/tags/statistics">Statistics</a> 
    
    
  </p>
</div>

<main>
<style>body {text-align: justify}</style>
<!--!jupyter nbconvert notebooks/2023-11-02-From-R-To-Julia.ipynb --to markdown  --output 2023-11-02-From-R-To-Julia --output-dir "/Users/gianlucamastrantonio/Dropbox (Politecnico di Torino Staff)/lavori/gitrepo/gianlucamastrantonio.github.io/content/post" -->
<p>I love programming and R is a fantastic language for statisticians. It&rsquo;s super flexible and great for data treatment. R has a lot of great qualities, but speed isn&rsquo;t one of them, which can be a problem if you&rsquo;re a Bayesians dealing with complex models. I used to call C++ inside R code to speed things up, so I could do all the initial data handling in R, and then let C++ do the real computation.  It worked well for me for quite some time, but let&rsquo;s be honest, debugging C++ code is a nightmare especially for someone like me who&rsquo;s not a computer scientist (and I&rsquo;m sure to I&rsquo;m not the only one with this problem), and dealing with compiler errors, missing libraries, and linking issues got old
really fast.  So, in early 2020, I had enough of C++. That&rsquo;s when I heard about Julia.  I printed out the whole Julia manual (yes, on paper) just a couple of days prior the first Covid lockdown in Italy.</p>
<p>I was stuck at home, with just Julia manual, and I thought, &ldquo;Why not give it a shot?&rdquo; I had a couple of ideas for modeling animal behavior, and I decided to try implementing them in Julia. Since then, I&rsquo;ve ditched C++, and now, when I need to write code that&rsquo;s fast, reliable, and efficient, Julia is my go-to. Looking back at the code I wrote for those two projects, which you can find <a href="https://github.com/GianlucaMastrantonio/multiple_animals_movement_model">here</a> and <a href="https://github.com/GianlucaMastrantonio/STAP_HMM_model">here</a>, even though they&rsquo;re not perfect, I&rsquo;m still amazed at how, with just a bit of knowledge, I could write code way faster than I ever could in C++.  These ideas are published (<a href="https://doi.org/10.1111/rssc.12561">here</a> and <a href="https://projecteuclid.org/journals/annals-of-applied-statistics/volume-16/issue-3/Modeling-animal-movement-with-directional-persistence-and-attractive-points/10.1214/21-AOAS1584.short">here</a>)</p>
<p>I think that for a person that knows R, switching to Julia is extremly simple.  It only takes a couple of days to get the hang of it and start implementing complex models. In fact, all my PhD students and some of my master&rsquo;s students use Julia. I&rsquo;ve even given a few seminars on how to use Julia for speedy computations, and I thought it was a good idea to put it in a blog post.</p>
<p>The codes I will use can be found also <a href="https://github.com/GianlucaMastrantonio/FromRtoJulia">here</a>. I&rsquo;m using Julia version 1.8.2.</p>
<h1 id="tutorial">Tutorial</h1>
<h2 id="the-model">The model</h2>
<p>I just want to emphasize right from the start that I&rsquo;m not an expert, and I&rsquo;m pretty sure that there are better and different ways to do some of the things I&rsquo;m about to explain. I might even have some concepts completely misunderstood (there are still parts of Julia that I use without fully grasping). We can now start with the tutorial.</p>
<p>My idea is to try to implement a simple Bayesian regression model. I will assume that the data \(\mathbf{y}=(y_1, \dots , y_n)\) come from the model
$$
\mathbf{y} = \mathbf{X}\boldsymbol{\beta}+ \boldsymbol{\epsilon}
$$
where \(\boldsymbol{\epsilon} \sim N(\mathbf{0}, \sigma^2\mathbf{I})\), \(\mathbf{X}\) is a \(n \times d\) matrix of coefficients and  \(\boldsymbol{\beta}\) is a d-dimensional vector of regressors. The priors are
$$
\boldsymbol{\beta} \sim N(\mathbf{M}, \mathbf{V}) \ \ \ \ \ \ \ \ \ \ \ \sigma^2  \sim IG(a,b)
$$
Given these priors, the full conditionals of \(\boldsymbol{\beta}\) and \(\sigma^2\) are available in closed form and they are
$$
\boldsymbol{\beta} | \sigma^2, \mathbf{y} \sim N(\mathbf{M}_p, \mathbf{V}_p)
$$
with
$$
\mathbf{V}_p = \left(\frac{n}{\sigma^2} + \mathbf{V}^{-1}\right)^{-1} \ \ \ \ \  \ \mathbf{M}_p = \mathbf{V}_p \left(\frac{\mathbf{X}^T\mathbf{X}}{\sigma^2} + \mathbf{N}\mathbf{V}^{-1}\right)^{-1}
$$
and
$$
\sigma^2| \boldsymbol{\beta}, \mathbf{y} \sim IG \left(a+\frac{n}{2}, b+ \frac{\left( \mathbf{y}- \mathbf{X}\boldsymbol{\beta} \right)^T \left( \mathbf{y}- \mathbf{X}\boldsymbol{\beta} \right)}{2} \right)
$$
In the code I will assume  a prior  for  \(\boldsymbol{\beta}\) with independent components.</p>
<h2 id="julia">Julia</h2>
<p>When it comes to running Julia code, you have a choice of using the terminal or a more user-friendly option: <strong>Visual Studio Code</strong>. To make your experience with Julia smoother, I strongly recommend using Visual Studio Code. You can follow this <a href="https://code.visualstudio.com/docs/languages/julia">link</a> for guidance on setting up Julia within Visual Studio Code.</p>
<p>The most challenging part of this tutorial lies in the initial configuration of Julia. It&rsquo;s essential to start by creating a new Julia package for your code. While creating a package may not always be your first instinct, it offers several advantages, especially when working with the <strong>Revise</strong> package, which I&rsquo;ll explain in detail later on. This approach will ultimately make your code development process more efficient.</p>
<h3 id="package-creation">Package creation</h3>
<p>I&rsquo;m naming this package <strong>RtoJulia</strong>. We can use a function to generate the package structure. Let&rsquo;s open Julia, which can be done by typing &ldquo;julia&rdquo; in the terminal if you haven&rsquo;t set up a keyboard shortcut. Once you&rsquo;re inside Julia, you&rsquo;ll need to enter the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Pkg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">generate</span><span style="color:#111">(</span><span style="color:#d88200">&#34;DirectoryOfThePackage_RtoJulia&#34;</span><span style="color:#111">)</span>
</span></span></code></pre></div><p>which will create the following structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>|-- RtoJulia
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>|-- src
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    ---RtoJulia.jl
</span></span></code></pre></div><p>It consists of a folder with the same name as the package. Inside this folder, you should create a <strong>src</strong> subdirectory, and within that, a <strong>.jl</strong> file named after the package itself. The structure of the <strong>RtoJulia.jl</strong> file should adhere to the following format:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">module</span> <span style="color:#111">RtoJulia</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>Indeed, to make this package functional, you&rsquo;ll need files, functions, and dependencies. These files should be placed within the <strong>src</strong> folder, and you can organize them in subfolders as needed. For example, in this example, we will have a file named <strong>model.jl</strong> that contains the MCMC algorithm implemented in the function <strong>mcmc()</strong>. Additionally, there&rsquo;s a folder named <strong>mcmc</strong>, which contains the files <strong>sample_beta.jl</strong> and <strong>sample_sigma2.jl</strong>, each responsible for implementing the specific full conditional: this file and folder must be created, even if they are still empty. We don&rsquo;t need a file for each function, but I think that in this way the code is more organized. This results in the following package structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>|-- RtoJulia
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>|-- src
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    --- RtoJulia.jl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    --- model.jl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    |-- mcmc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>        --- sample_beta.jl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>        --- sample_sigma2.jl
</span></span></code></pre></div><p>In this package, you&rsquo;ll need to utilize several external packages, all of which are available on GitHub:</p>
<ul>
<li><strong>Distributions</strong>: This package provides a wide range of probability distributions and related functions.</li>
<li><strong>Random</strong>: It allows you to work with random number generation and related functionalities.</li>
<li><strong>LinearAlgebra</strong>: This package offers essential linear algebra operations.</li>
<li><strong>PDMat</strong>s: PDMats is a package for positive definite matrices and operations.</li>
<li><strong>StatsBase</strong>: It provides fundamental statistics functionality for your package.</li>
</ul>
<p>Then, the inside of the <strong>RtoJulia.jl</strong> is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">module</span> <span style="color:#111">RtoJulia</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#00a8c8">using</span> <span style="color:#111">Distributions</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    <span style="color:#00a8c8">using</span> <span style="color:#111">Random</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#00a8c8">using</span> <span style="color:#111">LinearAlgebra</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#00a8c8">using</span> <span style="color:#111">PDMats</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#00a8c8">using</span> <span style="color:#111">StatsBase</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    <span style="color:#111">include</span><span style="color:#111">(</span><span style="color:#111">joinpath</span><span style="color:#111">(</span><span style="color:#d88200">&#34;model.jl&#34;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    <span style="color:#111">include</span><span style="color:#111">(</span><span style="color:#111">joinpath</span><span style="color:#111">(</span><span style="color:#d88200">&#34;mcmc/sample_beta.jl&#34;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    <span style="color:#111">include</span><span style="color:#111">(</span><span style="color:#111">joinpath</span><span style="color:#111">(</span><span style="color:#d88200">&#34;mcmc/sample_sigma2.jl&#34;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#00a8c8">export</span> <span style="color:#111">mcmc</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>Where <strong>include(joinpath())</strong> is used to specify the location of the files, <strong>using NAMEPACKAGE</strong> is the Julia equivalent R <strong>library(NAMEPACKAGE)</strong>,  and export is employed to define which functions should be accessible outside the package. The <strong>export mcmc</strong> should be commented out until we write the function: you can comment part of the code with #, as in R.
To conclude the package setup, you&rsquo;ll need to create the <strong>Manifest.toml</strong> and <strong>Project.toml</strong> files using the appropriate function. While the exact details of what these files do are not completely clear to me, but they are essential for your package.
Let&rsquo;s open Julia. Once you&rsquo;re inside Julia, you&rsquo;ll need to enter the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Pkg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">activate</span><span style="color:#111">(</span><span style="color:#d88200">&#34;DirectoryOfThePackage_RtoJulia&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Distributions&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Random&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;LinearAlgebra&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;PDMats&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;StatsBase&#34;</span><span style="color:#111">)</span>
</span></span></code></pre></div><p>In Julia, <strong>Pkg.add()</strong> is equivalent to R <strong>install.packages()</strong>. Additionally, <strong>Pkg.activate()</strong> is employed to specify the folder in which you want to add these packages. Again, the precise mechanics of this process are not entirely clear to me.</p>
<p>The good news is that your package is now ready to be utilized.</p>
<h3 id="installing-the-project-packages">Installing the project packages</h3>
<p>For the first-time setup, you&rsquo;ll need to install the necessary packages for this project. If you create a new project, you&rsquo;ll need to repeat this installation step. While there is a way to install packages only once for all projects, based on my experience, it&rsquo;s often better to keep it project-dependent.</p>
<p>Remember, if you&rsquo;re not using the packages outside of the <strong>RtoJulia.jl</strong> package, you don&rsquo;t have to install them separately. However, in this example, we will need them. In addition to these packages, for the script, you&rsquo;ll also need:</p>
<ul>
<li><strong>Revise</strong>: This package provides the ability to automatically update your code without restarting Julia.</li>
<li><strong>RCall</strong>: It facilitates interaction between Julia and R, allowing you to use R functions and libraries within your Julia script.</li>
<li><strong>RtoJulia</strong>: you own package.
just run the following code:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Pkg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">activate</span><span style="color:#111">(</span><span style="color:#d88200">&#34;DirectoryOfTheProject&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Distributions&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Random&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;LinearAlgebra&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;PDMats&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;StatsBase&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Revise&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">add</span><span style="color:#111">(</span><span style="color:#d88200">&#34;RCall&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">develop</span><span style="color:#111">(</span><span style="color:#111">path</span><span style="color:#f92672">=</span><span style="color:#d88200">&#34;DirectoryOfThePackage_RtoJulia&#34;</span><span style="color:#111">)</span>
</span></span></code></pre></div><p>You will see that <strong>Pkg.activate</strong> will create a new <strong>Manifest.toml</strong> and <strong>Project.toml</strong> files in the project directory. Again <strong>Pkg.add()</strong> will add the package while <strong>Pkg.develop()</strong> will tell Julia where your package is, and that it is in development (it will be helpful with <strong>Revise</strong>).</p>
<h3 id="the-script">The script</h3>
<p>Now, you can create a script file wherever you like, and give it any name you prefer, as long as it has the <strong>.jl</strong> extension. In my case, I&rsquo;ll name it <strong>sim_and_posterior_samples.jl</strong>.
First, you&rsquo;ll need to activate the project and use the required packages. This can be done with the following code snippet. Please ensure that <strong>dir_project</strong> points to the directory where the <strong>Manifest.toml</strong> and <strong>Project.toml</strong> files of your project are located. Note that this step can be relatively slow, which is a known issue and disadvantage of Julia:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">dir_project</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;/Users/gianlucamastrantonio/Dropbox (Politecnico di Torino Staff)/lavori/gitrepo/FromRtoJulia&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Pkg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">Pkg</span><span style="color:#f92672">.</span><span style="color:#111">activate</span><span style="color:#111">(</span><span style="color:#111">dir_project</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Revise</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">Distributions</span><span style="color:#111">,</span> <span style="color:#111">Random</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">LinearAlgebra</span><span style="color:#111">,</span> <span style="color:#111">PDMats</span><span style="color:#111">,</span> <span style="color:#111">StatsBase</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">RtoJulia</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#00a8c8">using</span> <span style="color:#111">RCall</span>
</span></span></code></pre></div><pre><code>[32m[1m  Activating[22m[39m project at `~/Dropbox (Politecnico di Torino Staff)/lavori/gitrepo/FromRtoJulia`
</code></pre>
<p>I simulate \(\mathbf{X}\) with</p>
<ul>
<li>n = 10000</li>
<li>d = 2</li>
</ul>
<p>and elements that are from a $N(0.0, \sqrt{2.0})</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">n</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Int64</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">d</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Int64</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#111">xmat</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}(</span><span style="color:#111">undef</span><span style="color:#111">,</span> <span style="color:#111">n</span><span style="color:#111">,</span><span style="color:#111">d</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">d</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>    <span style="color:#111">xmat</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">Normal</span><span style="color:#111">(</span><span style="color:#ae81ff">0.0</span><span style="color:#111">,</span><span style="color:#ae81ff">2.0</span><span style="color:#111">),</span> <span style="color:#111">n</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>From this simple code, we can already see some of the characteristics of Julia.
The <strong>for</strong> syntax is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">for</span> <span style="color:#111">index</span> <span style="color:#f92672">=</span> <span style="color:#111">sequence_of_values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>As in R, <strong>a:b</strong> is used t0 indicate all the integers in [a,b].</p>
<p>IMPORTANT: arrays in Julia start at 1 and they are in column-major order.</p>
<p>To write efficient Julia code, it&rsquo;s crucial for Julia to know the data types of variables. This is achieved by using the <strong>namevariable::type</strong> syntax (but Julia will work even without).</p>
<p>In Julia, there are several essential types that you should be aware of, including <strong>Float64</strong>, <strong>Int64</strong>, <strong>Matrix{Float64}</strong>, <strong>Matrix{Int64}</strong>, and <strong>Vector{Float64}</strong>, <strong>Vector{Int64}</strong>: You can find detailed information about these types <a href="https://docs.julialang.org/en/v1/manual/types/">here</a>.</p>
<p>Similar to R, you can create a matrix in Julia using the following syntax:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat_test</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">(</span><span style="color:#111">undef</span><span style="color:#111">,</span> <span style="color:#111">n</span><span style="color:#111">,</span><span style="color:#111">d</span><span style="color:#111">);</span>
</span></span></code></pre></div><p>Here, the first argument specifies how to initialize the matrix, the second argument is the number of rows, and the third is the number of columns. However, in this case, Julia doesn&rsquo;t know what data type to expect for the matrix elements (e.g., Float or Int), and this can be determined using the <strong>typeof()</strong> function.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat_test</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">(</span><span style="color:#111">undef</span><span style="color:#111">,</span> <span style="color:#111">n</span><span style="color:#111">,</span><span style="color:#111">d</span><span style="color:#111">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">typeof</span><span style="color:#111">(</span><span style="color:#111">mat_test</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Matrix{Any}[90m (alias for [39m[90mArray{Any, 2}[39m[90m)[39m
</code></pre>
<p>This reveals that the type of the matrix i <strong>Any</strong>. On the other hand, if we use:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">typeof</span><span style="color:#111">(</span><span style="color:#111">xmat</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Matrix{Float64}[90m (alias for [39m[90mArray{Float64, 2}[39m[90m)[39m
</code></pre>
<p>the matrix has a specific type.</p>
<p>Another important aspect of Julia is that Distributions are represented as objects. For instance, you can create an object that represents a normal distribution with a mean of 10 and a standard deviation of 0.1 using the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">norm_var</span> <span style="color:#f92672">=</span> <span style="color:#111">Normal</span><span style="color:#111">(</span><span style="color:#ae81ff">10.0</span><span style="color:#111">,</span><span style="color:#ae81ff">0.1</span><span style="color:#f92672">^</span><span style="color:#ae81ff">0.5</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">typeof</span><span style="color:#111">(</span><span style="color:#111">norm_var</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Normal{Float64}
</code></pre>
<p>We can then ask for the CDF evaluated at 12</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">cdf</span><span style="color:#111">(</span><span style="color:#111">norm_var</span><span style="color:#111">,</span><span style="color:#ae81ff">11.0</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>0.9992172988709987
</code></pre>
<p>for the log-pdf</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">logpdf</span><span style="color:#111">(</span><span style="color:#111">norm_var</span><span style="color:#111">,</span><span style="color:#ae81ff">11.0</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>-4.76764598670765
</code></pre>
<p>We can have a random sample</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">norm_var</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>9.961229922673654
</code></pre>
<p>or 10</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">norm_var</span><span style="color:#111">,</span><span style="color:#ae81ff">10</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>10-element Vector{Float64}:
 10.262302584791907
  9.788293824665672
 10.102299700754221
  9.756018705010291
  9.969009161753803
  9.627477777656386
 10.297995071518969
 10.333047770626505
  9.292472105875051
  9.749284355975002
</code></pre>
<p>When you have a matrix or even a vector, you can access its elements using the syntax <strong>namevariable[indexrow, indexcolumn]</strong>. For example, if you want to access all the elements in a particular column, you can use <strong>:</strong> to specify the entire range.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">xmat</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span><span style="color:#f92672">:</span><span style="color:#111">]</span>
</span></span></code></pre></div><pre><code>2×2 Matrix{Float64}:
 -0.129689  2.40786
 -0.295174  2.73471
</code></pre>
<p>If, like me, you&rsquo;ve invested a lot of time in learning ggplot in R and still want to use it in your Julia workflow, there&rsquo;s a straightforward way to call R from Julia, thanks to the <strong>RCall package</strong>.</p>
<p>To start, you can copy objects into R using the <strong>@rput</strong> macro. For example, this command copies an object into R (if you don&rsquo;t want to display the results of a Julia operation, you can simply use a semicolon <strong>;</strong> at the end of it):</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#75af00">@rput</span> <span style="color:#111">xmat</span><span style="color:#111">;</span>
</span></span></code></pre></div><p>If you want to plot the first column of the <strong>xmat</strong> matrix using a standard R plot function, you can achieve this with the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#d88200">R</span><span style="color:#d88200">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#d88200">plot(xmat[,1])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#d88200">&#34;&#34;&#34;</span>
</span></span></code></pre></div><pre><code>RObject{NilSxp}
NULL
</code></pre>
<p>Unfortunately, I&rsquo;m unable to display R plots in this markdown environment, but I can assure you that if you execute the code in Julia, the R plot will indeed be generated and displayed.</p>
<p>Any command placed inside the triple-quoted block:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#d88200">R</span><span style="color:#d88200">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#d88200"># codes
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#d88200">&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>will be executed in the R environment, allowing you to leverage R&rsquo;s plotting capabilities within your Julia workflow.</p>
<p>If you create an object within R and you want to use it in Julia, you can achieve this by using the <strong>@rget</strong> macro. This allows you to seamlessly transfer objects from R to Julia, making it easy to work with R-generated data or results in your Julia code.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#d88200">R</span><span style="color:#d88200">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#d88200">an_r_object = 10
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#d88200">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#75af00">@rget</span> <span style="color:#111">an_r_object</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#111">an_r_object</span>
</span></span></code></pre></div><pre><code>10.0
</code></pre>
<p>Be aware that only standard Julia and R structure can be moved between the two.</p>
<p>To define the first row of <strong>xmat</strong> as the intercept, you have two options: using a for loop or broadcasting. The first approach is straightforward and can be implemented as follows:
The first one is easy, and can be done as</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">n</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#111">xmat</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>on the other hand, this code is not valid</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">xmat</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><pre><code>ArgumentError: indexed assignment with a single value to possibly many locations is not supported; perhaps use broadcasting `.=` instead?





Stacktrace:


 [1] setindex_shape_check(::Int64, ::Int64, ::Int64)


   @ Base ./indices.jl:261


 [2] _unsafe_setindex!(::IndexLinear, ::Matrix{Float64}, ::Int64, ::Base.Slice{Base.OneTo{Int64}}, ::Int64)


   @ Base ./multidimensional.jl:925


 [3] _setindex!


   @ ./multidimensional.jl:916 [inlined]


 [4] setindex!(::Matrix{Float64}, ::Int64, ::Function, ::Int64)


   @ Base ./abstractarray.jl:1399


 [5] top-level scope


   @ ~/Dropbox (Politecnico di Torino Staff)/lavori/gitrepo/gianlucamastrantonio.github.io/notebooks/2023-11-02-From-R-To-Julia.ipynb:1
</code></pre>
<p>When you&rsquo;re attempting to assign a scalar value to a vector, one solution is to use the following syntax:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">xmat</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">.=</span> <span style="color:#ae81ff">1</span><span style="color:#111">;</span>
</span></span></code></pre></div><h4 id="its-important-to-exercise-caution-when-making-assignments-in-julia">It&rsquo;s important to exercise caution when making assignments in Julia</h4>
<p>In Julia, there&rsquo;s the concept of immutable and mutable structures, which can be quite intricate for a tutorial. However, it&rsquo;s important to note that this introduces a significant issue if you&rsquo;re not careful.</p>
<p>To illustrate the problem, let&rsquo;s examine this code that creates two matrices: the first filled with zeros and the second with ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat0</span> <span style="color:#f92672">=</span> <span style="color:#111">zeros</span><span style="color:#111">(</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">mat1</span> <span style="color:#f92672">=</span> <span style="color:#111">ones</span><span style="color:#111">(</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">);</span>
</span></span></code></pre></div><p>Now, as we would typically do in R, we want to make the first matrix equal to the second one:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat0</span> <span style="color:#f92672">=</span> <span style="color:#111">mat1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat1</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>[1.0 1.0; 1.0 1.0; 1.0 1.0]
[1.0 1.0; 1.0 1.0; 1.0 1.0]
</code></pre>
<p>It may seem like we&rsquo;ve achieved the results we wanted, but here&rsquo;s where the issue arises. If we attempt to change the value of an element in <strong>mat0</strong>, something peculiar occurs with <strong>mat1</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat0</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat1</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>[10.0 1.0; 1.0 1.0; 1.0 1.0]
</code></pre>
<p>also the value of **<strong>mat1</strong> changed!! This happens because with</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat0</span> <span style="color:#f92672">=</span> <span style="color:#111">mat1</span>
</span></span></code></pre></div><p>we&rsquo;re essentially making both variables point to the same object (I know, it&rsquo;s not precisely a pointer, but the behavior is akin to what people familiar with C++ might expect). Consequently, if we change an element in one, the other is affected as well. To avoid this, and ensure safe copying of elements from one matrix or vector to another, you can use squared brackets:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat2</span> <span style="color:#f92672">=</span> <span style="color:#111">ones</span><span style="color:#111">(</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">mat2</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#f92672">:</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">mat0</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#f92672">:</span><span style="color:#111">];</span>
</span></span></code></pre></div><p>or the function <strong>deepcopy</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">mat3</span> <span style="color:#f92672">=</span> <span style="color:#111">deepcopy</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>3×2 Matrix{Float64}:
 10.0  1.0
  1.0  1.0
  1.0  1.0
</code></pre>
<p>To check if two variables are the same, we can use <strong>===</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">===</span><span style="color:#111">mat1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">===</span><span style="color:#111">mat2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">===</span><span style="color:#111">mat3</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>true
false
false
</code></pre>
<p>even thought the values inside the matrices are the same:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">==</span><span style="color:#111">mat1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">==</span><span style="color:#111">mat2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">mat0</span><span style="color:#f92672">==</span><span style="color:#111">mat3</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>true
true
true
</code></pre>
<p>This behavior of matrices, vectors, and arrays, while it can be surprising at times, can actually be helpful when writing code. It allows for more efficient memory usage and can lead to significant performance gains in certain situations.</p>
<p>It&rsquo;s worth noting that this behavior doesn&rsquo;t occur with scalar variables. Whether this behavior arises depends on how objects are defined, whether they are mutable or immutable.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">a1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">a2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">a1</span> <span style="color:#f92672">=</span> <span style="color:#111">a2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#111">a2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">a1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">a2</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>3
10
</code></pre>
<p>BACK TO THE CODE!</p>
<h3 id="data-simulation">Data simulation</h3>
<p>Now we are ready to simulate the data</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">sigma2</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">regcoef</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}</span> <span style="color:#f92672">=</span> <span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">Normal</span><span style="color:#111">(</span><span style="color:#ae81ff">0.0</span><span style="color:#111">,</span><span style="color:#ae81ff">1.0</span><span style="color:#111">),</span><span style="color:#111">d</span><span style="color:#111">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">ysim</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}</span> <span style="color:#f92672">=</span> <span style="color:#111">zeros</span><span style="color:#111">(</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span><span style="color:#111">n</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#111">xbeta</span> <span style="color:#f92672">=</span> <span style="color:#111">xmat</span><span style="color:#f92672">*</span><span style="color:#111">regcoef</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">n</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    <span style="color:#111">ysim</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">Normal</span><span style="color:#111">(</span><span style="color:#111">xbeta</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">],</span> <span style="color:#111">sigma2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">0.5</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>In Julia, operations involving matrices are always defined as matrix operations by default. If you want to perform element-wise operations, you should use the operations with the dot, such as <strong>.+</strong> for element-wise addition or <strong>./</strong> for element-wise division.</p>
<h2 id="the-functions">The functions</h2>
<p>Now we need to write the actual MCMC algorithm. But, prior to do that, it is important to understand how functions works in Julia. The basic syntax is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">name_function</span><span style="color:#111">(</span><span style="color:#111">arguments1</span><span style="color:#111">,</span> <span style="color:#111">argument2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#75715e">### compute something here</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#75715e">###</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">object_to_return</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>indeed more than 2 arguments are possible. For example</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#111">lengtside1</span><span style="color:#111">,</span> <span style="color:#111">lengtside2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#d88200">&#34;First function&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#111">area</span> <span style="color:#f92672">=</span> <span style="color:#111">lengtside1</span><span style="color:#f92672">*</span><span style="color:#111">lengtside2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">area</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span><span style="color:#ae81ff">2.1</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>First function



2.1
</code></pre>
<p>As you can see, there&rsquo;s no need to specify the names of the arguments. Julia uses the argument positions.  Julia truly shines when it has full knowledge of the types of all variables and elements. Therefore, specifying types, as in the following approach, can lead to better performance:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#111">lengtside1</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span> <span style="color:#111">lengtside2</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span><span style="color:#111">)</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Second function&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#111">area</span> <span style="color:#f92672">=</span> <span style="color:#111">lengtside1</span><span style="color:#f92672">*</span><span style="color:#111">lengtside2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">area</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">2.0</span><span style="color:#111">,</span><span style="color:#ae81ff">2.0</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Second function



4.0
</code></pre>
<p>The <strong>::Float64</strong> notation placed outside the parentheses is used to specify the type of the returned element. This provides Julia with crucial type information for optimal performance.</p>
<p>It&rsquo;s worth noting that we now have two functions with the same name. Julia allows this because it can differentiate between them based on the types of the arguments. If both arguments are of type Float64, the second function will be used; otherwise, the first one will be invoked. Furthermore, you can even create a new function to compute the area of a rectangle if the arguments are of type Int, demonstrating the flexibility and versatility of Julia.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#111">lengtside1</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Int64</span><span style="color:#111">,</span> <span style="color:#111">lengtside2</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Int64</span><span style="color:#111">)</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Third function&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#111">area</span> <span style="color:#f92672">=</span> <span style="color:#111">lengtside1</span><span style="color:#f92672">*</span><span style="color:#111">lengtside2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">area</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Third function



4.0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">2.0</span><span style="color:#111">,</span><span style="color:#ae81ff">2.0</span><span style="color:#111">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#111">area_of_a_rectangle</span><span style="color:#111">(</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span><span style="color:#ae81ff">2.0</span><span style="color:#111">);</span>
</span></span></code></pre></div><pre><code>Third function
Second function
First function
</code></pre>
<p>It&rsquo;s important to be aware that if one of your function&rsquo;s arguments is a mutable object, like a matrix or a vector, and you change one of its elements within the function, it will also be changed outside the function.
In Julia, when a function modifies the value of its argument, it&rsquo;s a common convention to add a <strong>!</strong> at the end of the function name to indicate this behavior. For example:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">area_of_a_rectangle!</span><span style="color:#111">(</span><span style="color:#111">lengtside1</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span> <span style="color:#111">lengtside2</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">})</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#d88200">&#34;Fourth function&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    <span style="color:#111">area</span> <span style="color:#f92672">=</span> <span style="color:#111">lengtside1</span><span style="color:#f92672">*</span><span style="color:#111">lengtside2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#111">lengtside2</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#111">lengtside1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">area</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#111">par1</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#111">par2</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#ae81ff">2</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#111">area_of_a_rectangle!</span><span style="color:#111">(</span><span style="color:#111">par1</span><span style="color:#111">,</span> <span style="color:#111">par2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">par1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#111">println</span><span style="color:#111">(</span><span style="color:#111">par2</span><span style="color:#111">)</span>
</span></span></code></pre></div><pre><code>Fourth function
2.0
[100.0]
</code></pre>
<p>As you can see in the example below, the element inside <strong>par2</strong> changes because it&rsquo;s a mutable object (a vector), while the scalar remains the same. This contrast in behavior is essential to understand when working with mutable and immutable objects in Julia.</p>
<h2 id="the-mcmc-algorithm">The MCMC algorithm</h2>
<p>Now, we can proceed to write the <strong>mcmc</strong> function within the package. In this process, the Revise package will prove highly beneficial. It automatically updates the package every time you make changes to a function within it, sparing you the need to manually intervene in the update process. This automation streamlines development and ensures that the latest code is always utilized.</p>
<p>My mcmc function is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">mcmc</span><span style="color:#111">(</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    <span style="color:#111">data</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#111">X</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    <span style="color:#111">mcmc</span><span style="color:#f92672">::</span><span style="color:#00a8c8">NamedTuple</span><span style="color:#111">{(</span><span style="color:#d88200">:iter</span><span style="color:#111">,</span> <span style="color:#d88200">:thin</span><span style="color:#111">,</span> <span style="color:#d88200">:burnin</span><span style="color:#111">),</span> <span style="color:#00a8c8">Tuple</span><span style="color:#111">{</span><span style="color:#00a8c8">Int64</span><span style="color:#111">,</span> <span style="color:#00a8c8">Int64</span><span style="color:#111">,</span> <span style="color:#00a8c8">Int64</span><span style="color:#111">}},</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#111">priors</span><span style="color:#f92672">::</span><span style="color:#00a8c8">NamedTuple</span><span style="color:#111">{(</span><span style="color:#d88200">:regcoef</span><span style="color:#111">,</span> <span style="color:#d88200">:sigma2</span><span style="color:#111">),</span> <span style="color:#00a8c8">Tuple</span><span style="color:#111">{</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span> <span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}}},</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#111">init</span><span style="color:#f92672">::</span><span style="color:#00a8c8">NamedTuple</span><span style="color:#111">{(</span><span style="color:#d88200">:regcoef</span><span style="color:#111">,</span> <span style="color:#d88200">:sigma2</span><span style="color:#111">),</span> <span style="color:#00a8c8">Tuple</span><span style="color:#111">{</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span> <span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#111">)</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Tuple</span><span style="color:#111">{</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    <span style="color:#111">ncov</span> <span style="color:#f92672">=</span> <span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">X</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    <span style="color:#111">SampleToSave</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Int64</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Int64</span><span style="color:#111">(</span><span style="color:#111">trunc</span><span style="color:#111">(</span><span style="color:#111">mcmc</span><span style="color:#f92672">.</span><span style="color:#111">iter</span><span style="color:#f92672">-</span><span style="color:#111">mcmc</span><span style="color:#f92672">.</span><span style="color:#111">burnin</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#111">mcmc</span><span style="color:#f92672">.</span><span style="color:#111">thin</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#111">regcoefMCMC</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}(</span><span style="color:#111">undef</span><span style="color:#111">,</span>  <span style="color:#111">ncov</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>    <span style="color:#111">regcoefMCMC</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span> <span style="color:#f92672">=</span>  <span style="color:#111">init</span><span style="color:#f92672">.</span><span style="color:#111">regcoef</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>    <span style="color:#111">regcoefOUT</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}(</span><span style="color:#111">undef</span><span style="color:#111">,</span>  <span style="color:#111">ncov</span><span style="color:#111">,</span> <span style="color:#111">SampleToSave</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>    <span style="color:#111">sigma2MCMC</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}(</span><span style="color:#111">undef</span><span style="color:#111">,</span>  <span style="color:#ae81ff">1</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>    <span style="color:#111">sigma2MCMC</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span> <span style="color:#f92672">=</span>  <span style="color:#111">init</span><span style="color:#f92672">.</span><span style="color:#111">sigma2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>    <span style="color:#111">sigma2OUT</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}(</span><span style="color:#111">undef</span><span style="color:#111">,</span>  <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#111">SampleToSave</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>    <span style="color:#75715e">### MCMC</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>    <span style="color:#111">thinburnin</span> <span style="color:#f92672">=</span> <span style="color:#111">mcmc</span><span style="color:#f92672">.</span><span style="color:#111">burnin</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>      
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>    <span style="color:#00a8c8">for</span> <span style="color:#111">iMCMC</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">SampleToSave</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        <span style="color:#00a8c8">for</span> <span style="color:#111">jMCMC</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">thinburnin</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>            <span style="color:#75715e">### sample beta</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>            <span style="color:#111">sample_beta!</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">,</span><span style="color:#111">X</span><span style="color:#111">,</span>  <span style="color:#111">priors</span><span style="color:#f92672">.</span><span style="color:#111">regcoef</span><span style="color:#111">,</span><span style="color:#111">regcoefMCMC</span><span style="color:#111">,</span> <span style="color:#111">sigma2MCMC</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>            <span style="color:#75715e">### sample sigma2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>            <span style="color:#111">sample_sigma2!</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">,</span><span style="color:#111">X</span><span style="color:#111">,</span>  <span style="color:#111">priors</span><span style="color:#f92672">.</span><span style="color:#111">sigma2</span><span style="color:#111">,</span><span style="color:#111">regcoefMCMC</span><span style="color:#111">,</span> <span style="color:#111">sigma2MCMC</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>        <span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>        <span style="color:#111">thinburnin</span> <span style="color:#f92672">=</span> <span style="color:#111">mcmc</span><span style="color:#f92672">.</span><span style="color:#111">thin</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>        <span style="color:#111">regcoefOUT</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#111">iMCMC</span><span style="color:#111">]</span> <span style="color:#f92672">.=</span> <span style="color:#111">regcoefMCMC</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>        <span style="color:#111">sigma2OUT</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">,</span><span style="color:#111">iMCMC</span><span style="color:#111">]</span> <span style="color:#f92672">.=</span> <span style="color:#111">sigma2MCMC</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>    <span style="color:#00a8c8">end</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">regcoefOUT</span><span style="color:#111">,</span> <span style="color:#111">sigma2OUT</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>The first argument of the function is the data, while the second is the matrix of covariates. The third argument is a <strong>NamedTuple</strong> of three integers. A <strong>NamedTuple</strong> is a collection of objects, somewhat akin to an R <strong>list</strong>. In this case, it indicates the total number of iterations, the thinning factor, and the burn-in value. You can create a <strong>NamedTuple</strong> as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">(</span><span style="color:#111">iter</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span><span style="color:#111">,</span> <span style="color:#111">thin</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#111">burnin</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#111">)</span>
</span></span></code></pre></div><p>Then we have a <strong>NamedTuple</strong> with the parameters of the priors. Notice that I&rsquo;m assuming
$$
\mathbf{M} = (0,0)^T \ \ \ \ \mathbf{V} = 1000.0 \mathbf{I}, \ \ \ \  a= 1, \ \ \ \ b = 1
$$
The last argument is the initial values of the parameters.</p>
<p>The object <strong>regcoefMCMC</strong> and <strong>sigma2MCMC</strong> contains the values of the current iterations, while <strong>regcoefOUT</strong> and <strong>sigma2OUT</strong> are employed to store the posterior samples. The computations are carried out within the two for loops, where we also discard the burn-in samples. Within these loops, you&rsquo;ll find the two functions responsible for sampling from the full conditionals. This process is at the core of the MCMC algorithm for Bayesian inference.</p>
<p>The function <strong>sample_beta!</strong> is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">sample_beta!</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span><span style="color:#111">X</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span>  <span style="color:#111">prior</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span><span style="color:#111">regcoefMCMC</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span> <span style="color:#111">sigma2MCMC</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">})</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#111">ncov</span> <span style="color:#f92672">=</span> <span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">X</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#111">XtX</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Symmetric</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">,</span> <span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}}</span> <span style="color:#f92672">=</span> <span style="color:#111">Symmetric</span><span style="color:#111">(</span><span style="color:#111">transpose</span><span style="color:#111">(</span><span style="color:#111">X</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#111">X</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#111">Xty</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">}</span> <span style="color:#f92672">=</span> <span style="color:#111">reshape</span><span style="color:#111">(</span><span style="color:#111">transpose</span><span style="color:#111">(</span><span style="color:#111">X</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">],</span> <span style="color:#111">(</span><span style="color:#111">ncov</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    <span style="color:#111">var_app</span> <span style="color:#f92672">=</span> <span style="color:#111">Symmetric</span><span style="color:#111">(</span><span style="color:#111">inv</span><span style="color:#111">(</span><span style="color:#111">XtX</span> <span style="color:#f92672">./</span> <span style="color:#111">sigma2MCMC</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">+</span>  <span style="color:#111">Diagonal</span><span style="color:#111">(</span> <span style="color:#111">[</span> <span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span>  <span style="color:#111">prior</span><span style="color:#111">[</span><span style="color:#ae81ff">2</span><span style="color:#111">]</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">ncov</span> <span style="color:#111">]</span> <span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    <span style="color:#111">mean_app</span> <span style="color:#f92672">=</span> <span style="color:#111">var_app</span> <span style="color:#f92672">*</span> <span style="color:#111">(</span><span style="color:#111">Xty</span> <span style="color:#f92672">./</span> <span style="color:#111">sigma2MCMC</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">.+</span> <span style="color:#111">prior</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">/</span>  <span style="color:#111">prior</span><span style="color:#111">[</span><span style="color:#ae81ff">2</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    <span style="color:#111">regcoefMCMC</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">MvNormal</span><span style="color:#111">(</span><span style="color:#111">mean_app</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">],</span><span style="color:#111">var_app</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>while The function <strong>sample_sigma2!</strong> is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#00a8c8">function</span> <span style="color:#111">sample_sigma2!</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span><span style="color:#111">X</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span>  <span style="color:#111">prior</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Vector</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span><span style="color:#111">regcoefMCMC</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">},</span> <span style="color:#111">sigma2MCMC</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Matrix</span><span style="color:#111">{</span><span style="color:#00a8c8">Float64</span><span style="color:#111">})</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#111">ncov</span> <span style="color:#f92672">=</span> <span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">X</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#111">mean</span> <span style="color:#f92672">=</span> <span style="color:#111">X</span><span style="color:#f92672">*</span><span style="color:#111">regcoefMCMC</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#111">para</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">Float64</span><span style="color:#111">(</span><span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">],</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span><span style="color:#111">)</span> <span style="color:#f92672">+</span>  <span style="color:#111">prior</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    <span style="color:#111">parb</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Float64</span> <span style="color:#f92672">=</span> <span style="color:#111">transpose</span><span style="color:#111">((</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span><span style="color:#f92672">-</span><span style="color:#111">mean</span><span style="color:#111">))</span><span style="color:#f92672">*</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span><span style="color:#f92672">-</span><span style="color:#111">mean</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span> <span style="color:#f92672">+</span>  <span style="color:#111">prior</span><span style="color:#111">[</span><span style="color:#ae81ff">2</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    <span style="color:#111">sigma2MCMC</span><span style="color:#111">[</span><span style="color:#f92672">:</span><span style="color:#111">]</span> <span style="color:#f92672">.=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#111">rand</span><span style="color:#111">(</span><span style="color:#111">Gamma</span><span style="color:#111">(</span><span style="color:#111">para</span><span style="color:#111">,</span><span style="color:#ae81ff">1.0</span><span style="color:#f92672">/</span><span style="color:#111">parb</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#00a8c8">end</span>
</span></span></code></pre></div><p>Notice that in both there is not <strong>return</strong> since they only change the values of the <strong>Matrix</strong> object <strong>regcoefMCMC</strong> and <strong>sigma2MCMC</strong>.</p>
<p>The last component of the <strong>mcmc</strong> function is</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#00a8c8">return</span> <span style="color:#111">regcoefOUT</span><span style="color:#111">,</span> <span style="color:#111">sigma2OUT</span>
</span></span></code></pre></div><p>The return type specification <strong>Tuple</strong> indicates that the function is expected to return two objects, which are then combined and placed inside a <strong>Tuple</strong>.
TO be extra precise, at the end of the round parenthesis of the <strong>mcmc</strong> function I specified the output type as <strong>::Tuple{Matrix{Float64}, Matrix{Float64}}</strong>.</p>
<p>To conclude,  we can call this function in the script with</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">regcoefOUT</span><span style="color:#111">,</span> <span style="color:#111">sigma2OUT</span> <span style="color:#f92672">=</span> <span style="color:#111">mcmc</span><span style="color:#111">(</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#111">ysim</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#111">xmat</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#111">(</span><span style="color:#111">iter</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span><span style="color:#111">,</span> <span style="color:#111">thin</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#111">burnin</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#111">),</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#111">(</span><span style="color:#111">regcoef</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#ae81ff">0.0</span><span style="color:#111">,</span><span style="color:#ae81ff">1000.0</span><span style="color:#111">],</span> <span style="color:#111">sigma2</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#ae81ff">1.0</span><span style="color:#111">,</span><span style="color:#ae81ff">1.0</span><span style="color:#111">]),</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    <span style="color:#111">(</span><span style="color:#111">regcoef</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#ae81ff">0.0</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">xmat</span><span style="color:#111">,</span><span style="color:#ae81ff">2</span><span style="color:#111">)],</span> <span style="color:#111">sigma2</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#ae81ff">1.0</span><span style="color:#111">]),</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#111">);</span>
</span></span></code></pre></div><p>The line</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#111">regcoefOUT</span><span style="color:#111">,</span> <span style="color:#111">sigma2OUT</span> <span style="color:#f92672">=</span> <span style="color:#111">mcmc</span><span style="color:#111">(</span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>serves to specify where to assign the two objects returned by the mcmc function. It&rsquo;s important to note that the return object and the outside object don&rsquo;t necessarily have to share the same name.</p>
<p>After obtaining the posterior samples in Julia using <strong>regcoefOUT</strong> and <strong>sigma2OUT</strong>, you can further analyze and validate your results by transferring these samples, along with the real values used to simulate the data, into R.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-julia" data-lang="julia"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#75af00">@rput</span> <span style="color:#111">regcoefOUT</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#75af00">@rput</span> <span style="color:#111">sigma2OUT</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#75af00">@rput</span> <span style="color:#111">regcoef</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#75af00">@rput</span> <span style="color:#111">sigma2</span><span style="color:#111">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#d88200">R</span><span style="color:#d88200">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#d88200">par(mfrow=c(3,3))
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#d88200">i =1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#d88200">plot(regcoefOUT[i,], type=&#34;l&#34;)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#d88200">abline(h =regcoefOUT[i], col=2, lwd=2)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#d88200">acf(regcoefOUT[i,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#d88200">hist(regcoefOUT[i,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#d88200">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#d88200">i =2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#d88200">plot(regcoefOUT[i,], type=&#34;l&#34;)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span><span style="color:#d88200">abline(h =regcoefOUT[i], col=2, lwd=2)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#d88200">acf(regcoefOUT[i,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span><span style="color:#d88200">hist(regcoefOUT[i,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style="color:#d88200">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style="color:#d88200">plot(sigma2OUT[1,], type=&#34;l&#34;)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#d88200">abline(h =sigma2, col=2, lwd=2)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#d88200">acf(sigma2OUT[1,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span><span style="color:#d88200">hist(sigma2OUT[1,])
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span><span style="color:#d88200">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span><span style="color:#d88200">&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Again, the plots are not showing here, but the will in your project.</p>
<h1 id="conclusion">Conclusion</h1>
<p>I sincerely hope that this tutorial has provided you with a glimpse into the world of Julia. Please be aware that this tutorial only scratches the surface of what Julia can achieve. We haven&rsquo;t delved into topics such as how to define a struct, how to use multiple dispatch effectively, how to utilize parametric types, and many more advanced concepts.</p>
<p>In any event, if you have questions or require further assistance on this or any other topic, please don&rsquo;t hesitate to reach out. I&rsquo;m happy to help!</p>
<p><strong>The music I listen to while writing</strong></p>
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/album/6wtDAlsbBwBpTLxsIxqqUD?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/album/7BYMJZFCYuGKi2jblMhyxg?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/album/4mwrMLVKo940qLFXEIef4w?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/album/5k42mshjg1CNN4nDIIM7Xx?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

</main>

  <footer>
  
  <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "disqgmastrantonio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script defer src="//yihui.org/js/math-code.js"></script>
<script defer src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script defer src="//yihui.org/js/center-img.js"></script>

  
  <hr/>
  © <a href="https://www.polito.it/personale?p=041089">Gianluca Mastrantonio</a> 2023 &ndash; 2023 | <a href="https://github.com/GianlucaMastrantonio">Github</a> | <a href="https://www.researchgate.net/profile/Gianluca-Mastrantonio">Researchgate</a>
  
  </footer>
  </body>
</html>

